<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>so_long Rendering Pipeline</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .diagram {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .pipeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
        }
        .pipeline-step {
            background: #e1e1e1;
            padding: 10px;
            border-radius: 5px;
            width: 150px;
            text-align: center;
        }
        .arrow {
            font-size: 24px;
            color: #666;
        }
        .code-sample {
            background: #272822;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .memory-diagram {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 20px 0;
        }
        .timeline {
            position: relative;
            padding: 20px 0;
        }
        .timeline-item {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-left: 3px solid #333;
        }
    </style>
</head>
<body>
    <h1>so_long Rendering Pipeline Documentation</h1>

    <h2>1. Rendering Overview</h2>
    <div class="diagram">
        <h3>Main Rendering Pipeline</h3>
        <div class="pipeline">
            <div class="pipeline-step">MLX Loop</div>
            <div class="arrow">→</div>
            <div class="pipeline-step">Animate()</div>
            <div class="arrow">→</div>
            <div class="pipeline-step">Render Frame</div>
            <div class="arrow">→</div>
            <div class="pipeline-step">Display</div>
        </div>
    </div>

    <h2>2. Double Buffering System</h2>
    <div class="memory-diagram">
        <pre>
┌─────────────────┐     ┌─────────────────┐
│   Back Buffer   │ --> │  Screen Buffer   │
│  (game->buffer) │     │   (MLX Window)   │
└─────────────────┘     └─────────────────┘
        ^
        │
   Render Layers:
   1. Floor
   2. Walls
   3. Exit
   4. Player
   5. Collectibles
        </pre>
    </div>

    <h2>3. Animation Timeline</h2>
    <div class="timeline">
        <div class="timeline-item">Frame Update (every 15 ticks)</div>
        <div class="timeline-item">Player Animation (6 frames)</div>
        <div class="timeline-item">Collectibles Animation (8 frames)</div>
    </div>

    <h2>4. Code Structure</h2>
    <div class="code-sample">
        <pre>
MLX Loop
  └─► animate()
        ├─► Update frame counter
        ├─► Handle running state
        └─► render_frame()
              ├─► Clear buffer
              ├─► Draw floor
              ├─► Draw walls
              ├─► Draw entities
              └─► Display buffer
        </pre>
    </div>

    <h2>5. Memory Layout</h2>
    <div class="memory-diagram">
        <pre>
Game Buffer (32x32 tiles)
┌────┬────┬────┬────┐
│ 0,0│0,1 │... │0,w │
├────┼────┼────┼────┤
│1,0 │1,1 │... │1,w │
├────┼────┼────┼────┤
│... │... │... │... │
├────┼────┼────┼────┤
│h,0 │h,1 │... │h,w │
└────┴────┴────┴────┘
        </pre>
    </div>

    <h2>6. Sprite Management</h2>
    <div class="diagram">
        <h3>Sprite Arrays</h3>
        <ul>
            <li>Player Idle: 6 frames</li>
            <li>Player Run: 6 frames</li>
            <li>Collectibles: 8 frames</li>
            <li>Floor Variants: 10 types</li>
        </ul>
    </div>

    <h2>7. Performance Considerations</h2>
    <ul>
        <li>Double buffering prevents screen tearing</li>
        <li>Frame delay (15 ticks) controls animation speed</li>
        <li>Single-pass rendering minimizes memory operations</li>
        <li>Transparency handling in put_img_to_img</li>
    </ul>

    <script>
        // Add any interactive elements here if needed
    </script>
</body>
</html>
